<!DOCTYPE html>
<html>
  <head>
    <title>DuLeone Craps</title>
    <link href="layout.css" media="all" rel="stylesheet" type="text/css" />
    <link href="css3-gmail-style.css" media="all" rel="stylesheet" type="text/css" />
  </head>
  <body>
    <!-- canvas id="board" height='1024' width='768'></canvas -->
    <canvas id="board"></canvas>
    
    <div id='betForm' class='round'>
      <fieldset id='betInfo' class='round'>
        <legend>Create a Bet!</legend>
        <p>
          <label for='betType'>Bet Type</label>
          <select id='betType' name='betType'></select><br />
          <p id='betName'></p>
          <p id='betDesc'></p>
          <label id='betValLabel' for='betValue'>Bet Value</label>
          <input id='betValue' name='betValue' type='text' onchange='updateSlider(this.value)' /><br />
          <input id='betValSlide' name='betValue' type='range' min='0' max='10000' step='10' value='10' onchange='betValSlide(this.value)' /><br />
          <label for='repeat'>Repeat Bet on Win?</label>
          <input id='betRepeat' name='betRepeat' type='checkbox' />
        </p>
        <p id='origBet'></p>
        <p>
          <div id='create' unselectable='on' class='bttn blue' onclick='create()'>Create Bet!</div>
          <div id='cancel' unselectable='on' class='bttn blue' onclick='cancel()'>Cancel</div>
        </p>
      </fieldset>
    </div>
    <div id='betListing'></div>
    <div id='playerArea'>
      <div id='name' class='name' onclick='updatePlayerName()'></div>
      <div id='bank'></div>
      <!--div id='roll' unselectable='on' class='bttn red' onclick='roll()'>Roll</div -->
      <!--div id='reset' unselectable='on' class='bttn red' onclick='reset()'>Reset Bets</div -->
    </div>
    <div id='buffer'></div>
    <div id='help' class='round'>
      <p>
        Help:
        <ul>
          <li>To set your name, click on/touch the name area!</li>
          <li>To place a bet, click on/touch the area of the board you want to place a bet!</li>
          <li>To place an odds bet, click on/touch the area of the board that you're placing odds. Then select Odds from the drop down!</li>
          <li>To change a bet's amount, click on the amount!</li>
          <li>To roll, click on/touch the red dice!</li>
          <li>If you want to save your session, clear all your bets and copy the URL. <br />
              When you come back to that URL, your game will pick up where you left off.<br />
               *** Any bets left on the table will be lost when you come back! ***</li>
        </ul>
      </p>
      <p>
        Key:
        <table>
          <tr>
            <th>Heading</th>
            <th>Meaning</td>
          </tr>
          <tr>
            <td class='imageKey'><img src='images/id-card_green_small.png'></td>
            <td class='keyText'>Bet Id</td>
          </tr>
          <tr>
            <td class='imageKey'><img src='images/shapes_small.png'></td>
            <td class='keyText'>Bet Type</td>
          </tr>
          <tr>
            <td class='imageKey'><img src='images/chips_small.png'></td>
            <td class='keyText'>Bet Amount</td>
          </tr>
          <tr>
            <td class='imageKey'><img src='images/power_button_black_small.png'></td>
            <td class='keyText'>Bet On?</td>
          </tr>
          <tr>
            <td class='imageKey'><img src='images/restart_small.png'></td>
            <td class='keyText'>Repeat Bet on Win?</td>
          </tr>
          <tr>
            <td class='imageKey'><img src='images/point_small.png'></td>
            <td class='keyText'>Bet Point</td>
          </tr>
          <tr>
            <td class='imageKey red'><img src='images/edit-clear_small.png'></td>
            <td class='keyText'>Clear All Bets</td>
          </tr>
        </table>
      </p>
      <div class='bttn red' style='float: right' onclick='closeHelp()'>Close</div>
    </div>
    
  </body>
  <footer>

    <script src="jquery.min.js" lang='javascript' type='text/javascript'></script>
    <script src="jquery.color.js" lang='javascript' type='text/javascript'></script>
    <script type='text/javascript' language='javascript' src='utils.js'></script>
    <script type='text/javascript' language='javascript' src='html5slider.js'></script>
    <script type='text/javascript' language='javascript' src='dice.js'></script>
    <script type='text/javascript' language='javascript' src='crapsDice.js'></script>
    <script type='text/javascript' language='javascript' src='bets.js'></script>
    <script type='text/javascript' language='javascript' src='crapsBets.js'></script>
    <script type='text/javascript' language='javascript' src='players.js'></script>
    <script type='text/javascript' language='javascript' src='crapsPlayers.js'></script>
    <script type='text/javascript' language='javascript' src='craps.js'></script>
    <script type='text/javascript' language='javascript' src='board.js'></script>

    <script type='text/javascript' language='javascript'>
      
      function draw(Board) {
          var canvas = document.getElementById("board"),
              colors = {
                  board: "#090",
                  border: "#000",
                  pointOff: "#000",
                  pointOn: "#fff",
                  lines: "#fff",
                  text: "#fff",
                  buttonText: '#000',
                  specialText: "#ff0",
                  finalText: "#f00"
              };
      
          var board = new Board(canvas, colors);
          board.draw();
      
          canvas.onclick = function(e) {
                console.log('(x = ' + ((e.clientX - board.canvas.offsetLeft)/ board.canvas.clientWidth) * 2000 + ',','y = ' +  ((e.clientY - board.canvas.offsetTop)/ board.canvas.clientHeight) * 1000 + ')');
              //console.log(board.processClick(e.clientX - canvas.offsetLeft, e.clientY - canvas.offsetTop));
              //ctx = board.context;
              //ctx.beginPath();
              //ctx.lineWidth = 5;
              //ctx.arc(((e.clientX - board.canvas.offsetLeft)/ board.canvas.clientWidth) * 2000,
              //        ((e.clientY - board.canvas.offsetTop)/ board.canvas.clientHeight) * 1000, 15, 2 * Math.PI, false);
              //ctx.fill();
              //ctx.closePath();
              //ctx.stroke();
              boardArea = board.processClick(e.clientX - canvas.offsetLeft, e.clientY - canvas.offsetTop);
              if(boardArea){
                if(boardArea.name == "Dice"){
                  roll();
                  return;
                }
                if(boardArea.name == "Help"){
                  openHelp();
                  return;
                }
                clickAreaPlaceBet(boardArea);
              }
          };
      
      }
      var drawer = setInterval(function(){draw(Board);}, 200);
      //draw(Board);
            
      function updateBetDesc(){
        switch($('#betType').val()){
        case "passline":
          $('#betDesc').html('Payout:<br /> 1 pays 1');
          break;
        case "passlineOdds":
          $('#betDesc').html('Payout:<br />Point 4, 10: 1 pays 2<br />Point 5, 9: 2 pays 3 <br />Point 6, 8: 5 pays 6');
          break;
        case "dontPass":
          $('#betDesc').html('Payout:<br /> 1 pays 1');
          break;
        case "dontPassOdds":
          $('#betDesc').html('Payout:<br />Point 4, 10: 2 pays 1<br />Point 5, 9: 3 pays 2 <br />Point 6, 8: 6 pays 5');
          break;
        case "come":
          $('#betDesc').html('Payout:<br /> 1 pays 1');
          break;
        case "comeOdds":
          $('#betDesc').html('Payout:<br />Point 4, 10: 1 pays 2<br />Point 5, 9: 2 pays 3 <br />Point 6, 8: 5 pays 6');
          break;
        case "dontCome":
          $('#betDesc').html('Payout:<br /> 1 pays 1');
          break;
        case "dontComeOdds":
          $('#betDesc').html('Payout:<br />Point 4, 10: 2 pays 1<br />Point 5, 9: 3 pays 2 <br />Point 6, 8: 6 pays 5');
          break;
        case "place4":
          $('#betDesc').html('Payout:<br /> 5 pays 9');
          break;
        case "place5":
          $('#betDesc').html('Payout:<br /> 5 pays 7');
          break;
        case "place6":
          $('#betDesc').html('Payout:<br /> 6 pays 7');
          break;
        case "place8":
          $('#betDesc').html('Payout:<br /> 6 pays 7');
          break;
        case "place9":
          $('#betDesc').html('Payout:<br /> 5 pays 7');
          break;
        case "place10":
          $('#betDesc').html('Payout:<br /> 5 pays 9');
          break;
        case "big6":
          $('#betDesc').html('Payout:<br /> 1 pays 1');
          break;
        case "big8":
          $('#betDesc').html('Payout:<br /> 1 pays 1');
          break;
        case "field":
          $('#betDesc').html('Payout:<br />Roll 3, 4, 9, 10, 11: 1 pays 1<br />Roll 2, 12: 1 pays 2');
          break;
        case "cAndE":
          $('#betDesc').html('Payout:<br />Craps: 1 pays 3<br />Yo-leven: 1 pays 7<br />No Minimum Bet');
          break;
        case "any7":
          $('#betDesc').html('Payout:<br />1 pays 4<br />No Minimum Bet<br />Increments of 3');
          break;
        case "hard4":
          $('#betDesc').html('Payout:<br /> 1 pays 7');
          break;
        case "hard6":
          $('#betDesc').html('Payout:<br /> 1 pays 9');
          break;
        case "hard8":
          $('#betDesc').html('Payout:<br /> 1 pays 9');
          break;
        case "hard10":
          $('#betDesc').html('Payout:<br /> 1 pays 7');
          break;
        case "aceTwo":
          $('#betDesc').html('Payout:<br /> 1 pays 15');
          break;
        case "snakeEyes":
          $('#betDesc').html('Payout:<br /> 1 pays 30');
          break;
        case "midnight":
          $('#betDesc').html('Payout:<br /> 1 pays 30');
          break;
        case "yoleven":
          $('#betDesc').html('Payout:<br /> 1 pays 15');
          break;
        case "anyCraps":
          $('#betDesc').html('Payout: 1 pays 7<br />No Minimum Bet<br />Increments of 4');
          break;
        case "horn":
          $('#betDesc').html('Payout:<br />Roll 2, 12: 4 pays 27<br />Roll 3, 11: 1 pays 3<br />No Minimum Bet<br />Increments of 4');
          break;
        case "world":
          $('#betDesc').html('Payout:<br />Roll 2, 12: 5 pays 26<br />Roll 3, 11: 5 pays 11<br />Roll 7: Push<br />No Minimum Bet<br />Increments of 5');
          break;
        default:
          return false;
        }
      };
      
      function clickAreaPlaceBet(area){
        addBet(area);
      }
      
      function betValSlide(value){
        $('#betValue').attr('value', value);
      }
      
      function updateSlider(val){
        $('#betValSlide').attr('value', val);
      }

      function addBet(area){
        $('#betRepeat').removeAttr('disabled');
        $('#betRepeat').attr('chekced');
        $('#betType').show();
        $('#betName').show();
        $('#betValSlide').attr('min', '0');
        $('#betValSlide').attr('max', Math.min(_CRAPS.maxBet, PlayerManager.players[0].player.bank));
        $('#betValSlide').attr('step', '100');
        $('#betValSlide').attr('value', '100');
        
        switch(area.name){
        case "Pass Line":
          $('#betType').empty();
          var opt = $(document.createElement('option'));
          opt.attr('value', 'passline');
          opt.html(area.name);
          var opt2 = $(document.createElement('option'));
          opt2.attr('value', 'passlineOdds');
          opt2.html('Pass Line Odds');
          $('#betRepeat').attr('checked','');
          $('#origBet').empty();
          if($('#betType').val() == 'passlineOdds'){
            var origBet = $('#origBet');
            var origLabel = $(document.createElement('label'));
            var orig = $(document.createElement('input'));
            orig.attr('type', 'text');
            orig.css({width: '50px'});
            orig.attr('id', 'orig');
            origLabel.html('Original Bet ID: ');
            origBet.append(origLabel).append(orig);
            $('#betRepeat').removeAttr('checked');
          }
          $('#betType').append(opt).append(opt2).attr('disabled', false);
          $('#betName').hide();
          updateBetDesc();
          break;
        case "Don't Pass":
          $('#betType').empty();
          var opt = $(document.createElement('option'));
          opt.attr('value', 'dontPass');
          opt.html('Don\'t Pass Line');
          var opt2 = $(document.createElement('option'));
          opt2.attr('value', 'dontPassOdds');
          opt2.html('Don\'t Pass Odds');
          $('#betRepeat').attr('checked','');
          $('#origBet').empty();
          if($('#betType').val() == 'dontPassOdds'){
            var origBet = $('#origBet');
            var origLabel = $(document.createElement('label'));
            var orig = $(document.createElement('input'));
            orig.attr('type', 'text');
            orig.css({width: '50px'});
            orig.attr('id', 'orig');
            origLabel.html('Original Bet ID: ');
            origBet.append(origLabel).append(orig);
            $('#betRepeat').removeAttr('checked');
          }
          $('#betType').append(opt).append(opt2).attr('disabled', false);
          $('#betName').hide();
          updateBetDesc();
          break;
        case "Come":
          $('#betType').empty();
          var opt = $(document.createElement('option'));
          opt.attr('value', 'come');
          opt.html('Come Line');
          var opt2 = $(document.createElement('option'));
          opt2.attr('value', 'comeOdds');
          opt2.html('Come Line Odds');
          $('#betRepeat').attr('checked','');
          $('#origBet').empty();
          if($('#betType').val() == 'comeOdds'){
            var origBet = $('#origBet');
            var origLabel = $(document.createElement('label'));
            var orig = $(document.createElement('input'));
            orig.attr('type', 'text');
            orig.css({width: '50px'});
            orig.attr('id', 'orig');
            origLabel.html('Original Bet ID: ');
            origBet.append(origLabel).append(orig);
            $('#betRepeat').removeAttr('checked');
          }
          $('#betType').append(opt).append(opt2).attr('disabled', false);
          $('#betName').hide();
          updateBetDesc();
          break;
        case "Don't Come":
          $('#betType').empty();
          var opt = $(document.createElement('option'));
          opt.attr('value', 'dontCome');
          opt.html('Don\'t Come Line');
          var opt2 = $(document.createElement('option'));
          opt2.attr('value', 'dontComeOdds');
          opt2.html('Don\'t Come Odds');
          $('#betRepeat').attr('checked'), '';
          $('#origBet').empty();
          if($('#betType').val() == 'dontComeOdds'){
            var origBet = $('#origBet');
            var origLabel = $(document.createElement('label'));
            var orig = $(document.createElement('input'));
            orig.attr('type', 'text');
            orig.css({width: '50px'});
            orig.attr('id', 'orig');
            origLabel.html('Original Bet ID: ');
            origBet.append(origLabel).append(orig);
            $('#betRepeat').removeAttr('checked');
          }
          $('#betType').append(opt).append(opt2).attr('disabled', false);
          $('#betName').hide();
          updateBetDesc();
          break;
        case "Place 4":
          $('#betType').empty();
          var opt = $(document.createElement('option'));
          opt.attr('value', 'place4');
          opt.html(area.name);
          $('#betType').append(opt);
          $('#betType').hide();
          $('#betName').html('Place 4');
          $('#betType').attr('disabled', 'true');
          $('#betRepeat').attr('checked', '');
          $('#origBet').empty();
          updateBetDesc();
          break;
        case "Place 5":
          $('#betType').empty();
          var opt = $(document.createElement('option'));
          opt.attr('value', 'place5');
          opt.html(area.name);
          $('#betType').append(opt);
          $('#betType').hide();
          $('#betName').html('Place 5');
          $('#betType').attr('disabled', 'true');
          $('#betRepeat').attr('checked', '');
          $('#origBet').empty();
          updateBetDesc();
          break;
        case "Place 6":
          $('#betType').empty();
          var opt = $(document.createElement('option'));
          opt.attr('value', 'place6');
          opt.html(area.name);
          $('#betType').append(opt);
          $('#betType').hide();
          $('#betName').html('Place 6');
          $('#betType').attr('disabled', 'true');
          $('#betRepeat').attr('checked', '');
          $('#betValSlide').attr('step', '60');
          $('#betValSlide').attr('value', '120');
          $('#origBet').empty();
          updateBetDesc();
          break;
        case "Place 8":
          $('#betType').empty();
          var opt = $(document.createElement('option'));
          opt.attr('value', 'place8');
          opt.html(area.name);
          $('#betType').append(opt);
          $('#betType').hide();
          $('#betName').html('Place 8');
          $('#betType').attr('disabled', 'true');
          $('#betValSlide').attr('step', '60');
          $('#betValSlide').attr('value', '120');
          $('#origBet').empty();
          $('#betRepeat').attr('checked', '');
          updateBetDesc();
          break;
        case "Place 9":
          $('#betType').empty();
          var opt = $(document.createElement('option'));
          opt.attr('value', 'place9');
          opt.html(area.name);
          $('#betType').append(opt);
          $('#betType').hide();
          $('#betName').html('Place 9');
          $('#betType').attr('disabled', 'true');
          $('#origBet').empty();
          $('#betRepeat').attr('checked', '');
          updateBetDesc();
          break;
        case "Place 10":
          $('#betType').empty();
          var opt = $(document.createElement('option'));
          opt.attr('value', 'place10');
          opt.html(area.name);
          $('#betType').append(opt);
          $('#betType').hide();
          $('#betName').html('Place 10');
          $('#betType').attr('disabled', 'true');
          $('#origBet').empty();
          $('#betRepeat').attr('checked', '');
          updateBetDesc();
          break;
        case "Big 6":
          $('#betType').empty();
          var opt = $(document.createElement('option'));
          opt.attr('value', 'big6');
          opt.html(area.name);
          $('#betType').append(opt);
          $('#betType').hide();
          $('#betName').html('Big 6');
          $('#betType').attr('disabled', 'true');
          $('#origBet').empty();
          $('#betRepeat').attr('checked', '');
          updateBetDesc();
          break;
        case "Big 8":
          $('#betType').empty();
          var opt = $(document.createElement('option'));
          opt.attr('value', 'big8');
          opt.html(area.name);
          $('#betType').append(opt);
          $('#betType').hide();
          $('#betName').html('Big 8');
          $('#betType').attr('disabled', 'true');
          $('#origBet').empty();
          $('#betRepeat').attr('checked', '');
          updateBetDesc();
          break;
        case "Field":
          $('#betType').empty();
          var opt = $(document.createElement('option'));
          opt.attr('value', 'field');
          opt.html(area.name);
          $('#betType').append(opt);
          $('#betType').hide();
          $('#betName').html('Field');
          $('#betType').attr('disabled', 'true');
          $('#origBet').empty();
          $('#betRepeat').attr('checked', '');
          updateBetDesc();
          break;
        case "C and E":
          $('#betType').empty();
          var opt = $(document.createElement('option'));
          opt.attr('value', 'cAndE');
          opt.html(area.name);
          $('#betType').append(opt);
          $('#betType').hide();
          $('#betName').html('C and E');
          $('#betType').attr('disabled', 'true');
          $('#betValSlide').attr('step', '20');
          $('#betValSlide').attr('value', '200');
          $('#origBet').empty();
          $('#betRepeat').removeAttr('checked');
          updateBetDesc();
          break;
        case "Seven":
          $('#betType').empty();
          var opt = $(document.createElement('option'));
          opt.attr('value', 'any7');
          opt.html(area.name);
          $('#betType').append(opt);
          $('#betType').hide();
          $('#betName').html('Any 7');
          $('#betType').attr('disabled', 'true');
          $('#betValSlide').attr('step', '30');
          $('#betValSlide').attr('value', '300');
          $('#origBet').empty();
          $('#betRepeat').removeAttr('checked');
          updateBetDesc();
          break;
        case "Hard 4":
          $('#betType').empty();
          var opt = $(document.createElement('option'));
          opt.attr('value', 'hard4');
          opt.html(area.name);
          $('#betType').append(opt);
          $('#betType').hide();
          $('#betName').html('Hard 4');
          $('#betType').attr('disabled', 'true');
          $('#origBet').empty();
          $('#betRepeat').attr('checked', '');
          updateBetDesc();
          break;
        case "Hard 6":
          $('#betType').empty();
          var opt = $(document.createElement('option'));
          opt.attr('value', 'hard6');
          opt.html(area.name);
          $('#betType').append(opt);
          $('#betType').hide();
          $('#betName').html('Hard 6');
          $('#betType').attr('disabled', 'true');
          $('#origBet').empty();
          $('#betRepeat').attr('checked', '');
          updateBetDesc();
          break;
        case "Hard 8":
          $('#betType').empty();
          var opt = $(document.createElement('option'));
          opt.attr('value', 'hard8');
          opt.html(area.name);
          $('#betType').append(opt);
          $('#betType').hide();
          $('#betName').html('Hard 8');
          $('#betType').attr('disabled', 'true');
          $('#origBet').empty();
          $('#betRepeat').attr('checked', '');
          updateBetDesc();
          break;
        case "Hard 10":
          $('#betType').empty();
          var opt = $(document.createElement('option'));
          opt.attr('value', 'hard10');
          opt.html(area.name);
          $('#betType').append(opt);
          $('#betType').hide();
          $('#betName').html('Hard 10');
          $('#betType').attr('disabled', 'true');
          $('#origBet').empty();
          $('#betRepeat').attr('checked', '');
          updateBetDesc();
          break;
        case "Ace Two":
          $('#betType').empty();
          var opt = $(document.createElement('option'));
          opt.attr('value', 'aceTwo');
          opt.html(area.name);
          $('#betType').append(opt);
          $('#betType').hide();
          $('#betName').html('Ace Two');
          $('#betType').attr('disabled', 'true');
          $('#origBet').empty();
          $('#betRepeat').removeAttr('checked');
          updateBetDesc();
          break;
        case "Snake Eyes":
          $('#betType').empty();
          var opt = $(document.createElement('option'));
          opt.attr('value', 'snakeEyes');
          opt.html(area.name);
          $('#betType').append(opt);
          $('#betType').hide();
          $('#betName').html('Snake Eyes');
          $('#betType').attr('disabled', 'true');
          $('#origBet').empty();
          $('#betRepeat').removeAttr('checked');
          updateBetDesc();
          break;
        case "Midnight":
          $('#betType').empty();
          var opt = $(document.createElement('option'));
          opt.attr('value', 'midnight');
          opt.html(area.name);
          $('#betType').append(opt);
          $('#betType').hide();
          $('#betName').html('Midnight');
          $('#betType').attr('disabled', 'true');
          $('#origBet').empty();
          $('#betRepeat').removeAttr('checked');
          updateBetDesc();
          break;
        case "Yo-leven":
          $('#betType').empty();
          var opt = $(document.createElement('option'));
          opt.attr('value', 'yoleven');
          opt.html(area.name);
          $('#betType').append(opt);
          $('#betType').hide();
          $('#betName').html('Yo-leven');
          $('#betType').attr('disabled', 'true');
          $('#origBet').empty();
          $('#betRepeat').removeAttr('checked');
          updateBetDesc();
          break;
        case "Craps":
          $('#betType').empty();
          var opt = $(document.createElement('option'));
          opt.attr('value', 'anyCraps');
          opt.html(area.name);
          $('#betType').append(opt);
          $('#betType').hide();
          $('#betName').html('Any Craps');
          $('#betType').attr('disabled', 'true');
          $('#origBet').empty();
          $('#betRepeat').removeAttr('checked');
          updateBetDesc();
          break;
        case "Horn":
          $('#betType').empty();
          var opt = $(document.createElement('option'));
          opt.attr('value', 'horn');
          opt.html(area.name);
          $('#betType').append(opt);
          $('#betType').hide();
          $('#betName').html('Horn');
          $('#betType').attr('disabled', 'true');
          $('#betValSlide').attr('step', '40');
          $('#betValSlide').attr('value', '400');
          $('#origBet').empty();
          $('#betRepeat').removeAttr('checked');
          updateBetDesc();
          break;
        case "World":
          $('#betType').empty();
          var opt = $(document.createElement('option'));
          opt.attr('value', 'world');
          opt.html(area.name);
          $('#betType').append(opt);
          $('#betType').hide();
          $('#betName').html('World');
          $('#betType').attr('disabled', 'true');
          $('#betValSlide').attr('step', '50');
          $('#betValSlide').attr('value', '500');
          $('#origBet').empty();
          $('#betRepeat').removeAttr('checked');
          updateBetDesc();
          break;
        default:
          return false;
        }
        
        place();
      }
      if(window.location.hash == ""){
        makeCrapsPlayer("Set your name!", 10000);
      } else {
        var crapsInfo = parseHash(window.location.hash);
        makeCrapsPlayer(crapsInfo[0].slice(1), crapsInfo[1]);
      }
      //_CRAPS.players = [p];
      
      function parseHash(str){
        var retArray = [];
        retArray.push(str.slice(0, str.indexOf('/')));
        retArray.push(parseInt(str.slice(str.indexOf('/') + 1), 36));
        return retArray;
      }

      var p = PlayerManager.players[0];
      PlayerManager.updatePlayerArea();
      
      var BET_FADE_INTERVAL = 2000;

      function roll(){
        _CRAPS.roll();
        //draw(Board);
        //$('#pointWindow').html('Point: ' + ((GameState.point>0)?GameState.point:'None'));
        if($('.winningBet').is(':animated') || $('.losingBet').is(':animated')){
          var animateTimeout = setInterval(
            function(){
              _CRAPS.dealer.betManager.displayBets();
              clearInterval(animateTimeout);
            }, BET_FADE_INTERVAL);
        }else{
          _CRAPS.dealer.betManager.displayBets();
        }
      }
      
      function reset(){
        var _bets = _CRAPS.dealer.betManager.bets
        for(x in _bets){
          if(_bets[x].type == 'passline'){
            if(GameState.point > 0){
              continue;
            }else{
              _CRAPS.dealer.betManager.removeBet(_bets[x].bet.betId);
            }
          }
          if(_bets[x].type == 'come'){
            if(_bets[x].point > 0){
              continue;
            }else{
              _CRAPS.dealer.betManager.removeBet(_bets[x].bet.betId);
            }
          }
          _CRAPS.dealer.betManager.removeBet(_bets[x].bet.betId);
        }
      }
      
      function place(){
        $('#betInfo').width($('#board').width() * (1/4));
        $('#betForm').show();
        $('#betForm').height($('#betInfo').height() + 8 + 4);
        $('#betForm').width($('#betInfo').width() + 8 + 4);
        //$('#betForm').animate({left: ($('#board').offset().left + $('#board').width() - $('#betForm').width() - (parseInt($('#betForm').css('padding')) * 2 + parseInt($('#betForm').css('margin')) * 2)), opacity: 1}, 1000);
        $('#betForm').animate({left: ($('#board').offset().left + $('#board').width() - $('#betForm').width() - (                4                        * 2 +                 2                     * 2)), opacity: 1}, 1000);
      }
      
      function closeHelp(){
        $('#help').animate({opacity: 0}, 1000, function(){$('#help').hide();});
      }
      
      function openHelp(){
        $('#help').show();
        $('#help').animate({opacity: 1}, 1000); 
      }
      
      function create(){
        //console.log($('#betType').val());
        //console.log($('#betValue').val());
        //console.log($('#betRepeat').is(':checked'));
        //console.log(parseInt($('#betValue').val()));
        var origBet = null;
        if(['passlineOdds', 'comeOdds', 'dontPassOdds', 'dontComeOdds'].indexOf($('#betType').val()) != -1){
          origBet = _CRAPS.dealer.betManager.getBetById($('#orig').val());
        }
        var newBet = p.createBet($('#betType').val(), parseInt($('#betValue').val()), $('#betRepeat').is(':checked'), origBet);
        //console.log('Placing bet:', newBet.toString());
        _CRAPS.placeBet(newBet);
        PlayerManager.updatePlayerArea();
        $('#betForm').animate({left: ($('#board').offset().left + $('#board').width() + 2), opacity: 0}, 1000, function(){$('#betForm').hide();});
      }
      
      function cancel(){
        $('#betForm').animate({left: ($('#board').offset().left + $('#board').width() + 2), opacity: 0}, 1000, function(){$('#betForm').hide();});
      }
      
      function updatePlayerName(){
        var player = PlayerManager.players[0];
        var nameDiv = $('#name');
        nameDiv.empty();
        var input = $(document.createElement('input'));
        input.attr('type', 'text');
        input.attr('id', 'nameInput');
        input.css({width: '50%'});
        $('#name').css({top: '5px'});
        $('#bank').css({top: ($('#name').offset().top + $('#name').height() - 30)});
        $('#buffer').css({top: ($('#bank').offset().top + $('#bank').height())});
        $('#buffer').height(($('#board').height() - $('#playerArea').height())/2);
        //$('#betListing').height($('#board').height() - $('#playerArea').height() - $('#buffer').height());
        input.attr('value', player.player.name);
        if(input.attr('value') == 'Set your name!'){
          input.attr('value', 'Your Name');
        }
        input.focus(function(){
          input.select();
          $('#bank').height(Math.max($('#availBank').offset().top, $('#inPlay').offset().top, $('#totBank').offset().top) + Math.max($('#availBank').height(), $('#inPlay').height(), $('#totBank').height()));
          $('#playerArea').height($('#bank').height() + 4);
          $('#buffer').css('top', $('#playerArea').height());
          $('#buffer').height(($('#board').height() - $('#playerArea').height())/2);
          //$('#betListing').height($('#board').height() - $('#playerArea').height() - $('#buffer').height());
          $('#betListing').css('top', ($('#buffer').offset().top + $('#buffer').height() + 2));
          $('#betListing').height($(window).height - $('#betListing').offset().top);
        });
        input.change(function(){
          player.changeName(input.val());
          PlayerManager.updatePlayerArea();
          $('#buffer').height(($('#board').height() - $('#playerArea').height())/2);
          //$('#betListing').height($('#board').height() - $('#playerArea').height() - $('#buffer').height());
          $('#betListing').css('top', ($('#buffer').offset().top + $('#buffer').height() + 2));
          $('#betListing').height($(window).height - $('#betListing').offset().top);
        });
        input.blur(function(){
          player.changeName(input.val());
          PlayerManager.updatePlayerArea();
          $('#buffer').height(($('#board').height() - $('#playerArea').height())/2);
          //$('#betListing').height($('#board').height() - $('#playerArea').height() - $('#buffer').height());
          $('#betListing').css('top', ($('#buffer').offset().top + $('#buffer').height() + 2));
          $('#betListing').height($(window).height - $('#betListing').offset().top);
        });
        nameDiv.append(input);
        input.focus();
      }
      
      function updateBet(idNum){
        var _betDisp = $('#bet' + idNum);
        var _betDispVal = $('#val' + idNum);
        var _bet = _CRAPS.dealer.betManager.getBetById(idNum);
        
        var oldVal = _betDispVal.html().slice(1);
        //console.log(oldVal);
        
        _betDispVal.empty();
        var input = $(document.createElement('input'));
        input.attr('type', 'text');
        //input.attr('id', 'nameInput');
        input.css({width: $('#val' + idNum).width()});
        input.attr('value', oldVal);
        input.focus(function(){
          input.select();
        });
        input.change(function(){
          var _betDispVal = $('#val' + idNum);
          var _bet = _CRAPS.dealer.betManager.getBetById(idNum);
          var oldVal = _bet.bet.value;
          var newAmount = input.val();
          var retArray = revalidate(_bet, newAmount)
          if(!retArray[0]){
            retArray[1]();
            return;
          }
          if(retArray[0] == 3){
            _betDispVal.empty();
            _betDispVal.html('$' + oldVal);
            retArray[1]();
            return;
          } else {
            _betDispVal.empty();
            _betDispVal.html('$' + newAmount);
            _bet.bet.value = parseInt(newAmount);
            var diff = (parseInt(newAmount) - parseInt(oldVal))
            _bet.bet.player.player.subFromBank(diff);
          }
          PlayerManager.updatePlayerArea();
          if(retArray[0] == 2){
            retArray[1]();
          }
        });
        input.blur(function(){
          var _betDispVal = $('#val' + idNum);
          var _bet = _CRAPS.dealer.betManager.getBetById(idNum);
          var oldVal = _bet.bet.value;
          var newAmount = input.val();
          var retArray = revalidate(_bet, newAmount)
          if(!retArray[0]){
            retArray[1]();
            return;
          }
          _betDispVal.empty();
          _betDispVal.html('$' + newAmount);
          _bet.bet.value = parseInt(newAmount);
          var diff = (parseInt(newAmount) - parseInt(oldVal))
          _bet.bet.player.player.subFromBank(diff);
          PlayerManager.updatePlayerArea();
          if(retArray[0] == 2){
            retArray[1]();
          }
        });
        _betDispVal.append(input);
        input.focus();
      }
      
      
      
      (function() {
        $('#betValue').attr('value', '100');
        $('#betValue').css({width: '50px'});
        $('#betForm').css({left: ($('#board').offset().left + $('#board').width() + 2)});
        $('#bank').height(Math.max($('#availBank').offset().top, $('#inPlay').offset().top, $('#totBank').offset().top) + Math.max($('#availBank').height(), $('#inPlay').height(), $('#totBank').height()));
        $('#playerArea').height($('#bank').height() + 4);
        $('#buffer').css('top', $('#playerArea').height());
        $('#buffer').height(($('#board').height() - $('#playerArea').height())/2);
        //$('#betListing').height($('#board').height() - $('#playerArea').height() - $('#buffer').height());
        $('#betListing').css('top', ($('#buffer').offset().top + $('#buffer').height() + 2));
        _CRAPS.dealer.betManager.displayBets();
        $('#betType').change(function(){
          $('#origBet').empty();
          $('#betRepeat').attr('disabled', 'false');
          $('#betRepeat').attr('checked', 'true');
          $('#betValSlide').attr('max', Math.min(_CRAPS.maxBet, PlayerManager.players[0].player.bank));
          $('#betValSlide').attr('value', $('#betValSide').val());
          var type = $('#betType').val();
          if(['passlineOdds', 'comeOdds', 'dontPassOdds', 'dontComeOdds'].indexOf(type) != -1){
            var origBet = $('#origBet');
            var origLabel = $(document.createElement('label'));
            var orig = $(document.createElement('input'));
            var bets = _CRAPS.dealer.betManager.bets;
            orig.attr('type', 'text');
            orig.css({width: '50px'});
            orig.attr('id', 'orig');
            if(type == 'passlineOdds' || type == 'dontPassOdds'){
              var _type = type.slice(0, 8);
              for(i in bets){
                if(bets[i].type == _type){
                  orig.attr('value', bets[i].bet.betId);
                }
              }
            }
            if(type == 'comeOdds' || type == 'dontComeOdds'){
              var _type = type.slice(0, -4);
              var valid = [];
              var odds = [];
              var oddsPoints = [];
              for(i in bets){
                if(bets[i].type == _type){
                  valid.push(bets[i]);
                }
                if(bets[i].type == type){
                  odds.push(bets[i]);
                  oddsPoints.push(bets[i].origBet.point);
                }
              }
              
              for(i in valid){
                if(oddsPoints.indexOf(valid[i].point) == -1){
                  orig.attr('value', valid[i].bet.betId);
                  break;
                }
              }
            }
            origLabel.html('Original Bet ID: ');
            origBet.append(origLabel).append(orig);
            var origVal;
            for(i in _CRAPS.dealer.betManager.bets){
              if(_CRAPS.dealer.betManager.bets[i].type == 'passline'){
                origVal = _CRAPS.dealer.betManager.bets[i].bet.value;
              }
            }
            if(type == 'passlineOdds'){
              if(GameState.point == 4 || GameState.point == 10){
                $('#betValSlide').attr('step', '50');
                $('#betValSlide').attr('value', $('#betValue').attr('value'));
                $('#betValSlide').attr('max', origVal * 3);
              } else if(GameState.point == 5 || GameState.point == 9){
                $('#betValSlide').attr('step', '50');
                $('#betValSlide').attr('value', $('#betValue').attr('value'));
                $('#betValSlide').attr('max', origVal * 4);
              } else if(GameState.point == 6 || GameState.point == 8){
                $('#betValSlide').attr('step', '50');
                $('#betValSlide').attr('value', $('#betValue').attr('value'));
                $('#betValSlide').attr('max', origVal * 5);
              }
            } else if(type == 'dontPassOdds'){
              if(GameState.point == 4 || GameState.point == 10){
                $('#betValSlide').attr('step', '50');
                $('#betValSlide').attr('value', $('#betValue').attr('value'));
                $('#betValSlide').attr('max', origVal * 6);
              } else if(GameState.point == 5 || GameState.point == 9){
                $('#betValSlide').attr('step', '30');
                $('#betValSlide').attr('value', $('#betValue').attr('value'));
                $('#betValSlide').attr('max', origVal * 8);
              } else if(GameState.point == 6 || GameState.point == 8){
                $('#betValSlide').attr('step', '60');
                $('#betValSlide').attr('value', $('#betValue').attr('value'));
                $('#betValSlide').attr('max', origVal * 10);
              }
            } else if(type == 'comeOdds'){
              origVal = _CRAPS.dealer.betManager.getBetById(orig.value).bet.value;
              if(_CRAPS.dealer.betManager.getBetById(orig.value).point == 4 || _CRAPS.dealer.betManager.getBetById(orig.value).point == 10){
                $('#betValSlide').attr('step', '50');
                $('#betValSlide').attr('value', $('#betValue').attr('value'));
                $('#betValSlide').attr('max', origVal * 3);
              } else if(_CRAPS.dealer.betManager.getBetById(orig.value).point == 5 || _CRAPS.dealer.betManager.getBetById(orig.value).point == 9){
                $('#betValSlide').attr('step', '50');
                $('#betValSlide').attr('value', $('#betValue').attr('value'));
                $('#betValSlide').attr('max', origVal * 4);
              } else if(_CRAPS.dealer.betManager.getBetById(orig.value).point == 6 || _CRAPS.dealer.betManager.getBetById(orig.value).point == 8){
                $('#betValSlide').attr('step', '50');
                $('#betValSlide').attr('value', $('#betValue').attr('value'));
                $('#betValSlide').attr('max', origVal * 5);
              }
            } else if(type == 'dontComeOdds'){
              origVal = _CRAPS.dealer.betManager.getBetById(orig.value).bet.value;
              if(_CRAPS.dealer.betManager.getBetById(orig.value).point == 4 || _CRAPS.dealer.betManager.getBetById(orig.value).point == 10){
                $('#betValSlide').attr('step', '50');
                $('#betValSlide').attr('value', $('#betValue').attr('value'));
                $('#betValSlide').attr('max', origVal * 6);
              } else if(_CRAPS.dealer.betManager.getBetById(orig.value).point == 5 || _CRAPS.dealer.betManager.getBetById(orig.value).point == 9){
                $('#betValSlide').attr('step', '30');
                $('#betValSlide').attr('value', $('#betValue').attr('value'));
                $('#betValSlide').attr('max', origVal * 8);
              } else if(_CRAPS.dealer.betManager.getBetById(orig.value).point == 6 || _CRAPS.dealer.betManager.getBetById(orig.value).point == 8){
                $('#betValSlide').attr('step', '60');
                $('#betValSlide').attr('value', $('#betValue').attr('value'));
                $('#betValSlide').attr('max', origVal * 10);
              }
            }
            $('#betRepeat').removeAttr('checked');
            $('#betRepeat').attr('disabled', 'true');
            $('#betForm').height($('#betInfo').height() + 8 + 4);
          }
          updateBetDesc();
          var _height = $('#betInfo').height() + 8 + 3;
          $('#betForm').css({height: _height});
          $('#help').hide();
        });
      })();
      
      function prettyToName(betType){
        switch(betType){
        case "Pass Line":
          return 'passline';
          break;
        case "Pass Line Odds":
          return 'passlineOdds';
          break;
        case "Don't Pass":
          return 'dontPass';
          break;
        case "Don't Pass Odds":
          return 'dontPassOdds';
          break;
        case "Come":
          return 'come';
          break;
        case "Come Odds":
          return 'comeOdds';
          break;
        case "Don't Come":
          return 'dontCome';
          break;
        case "Don't Come Odds":
          return 'dontComeOdds';
          break;
        case "Place 4":
          return 'place4';
          break;
        case "Place 5":
          return 'place5';
          break;
        case "Place 6":
          return 'place6';
          break;
        case "Place 8":
          return 'place8';
          break;
        case "Place 9":
          return 'place9';
          break;
        case "Place 10":
          return 'place10';
          break;
        case "Big 6":
          return 'big6';
          break;
        case "Big 8":
          return 'big8';
          break;
        case "Field":
          return 'field';
          break;
        case "C and E":
          return 'cAndE';
          break;
        case "Seven":
          return 'any7';
          break;
        case "Hard 4":
          return 'hard4';
          break;
        case "Hard 6":
          return 'hard6';
          break;
        case "Hard 8":
          return 'hard8';
          break;
        case "Hard 10":
          return 'hard10';
          break;
        case "Ace Two":
          return 'aceTwo';
          break;
        case "Snake Eyes":
          return 'snakeEyes';
          break;
        case "Midnight":
          return 'midnight';
          break;
        case "Yo-leven":
          return 'yoleven';
          break;
        case "Craps":
          return 'anyCraps';
          break;
        case "Horn":
          return 'horn';
          break;
        case "World":
          return 'world';
          break;
        default:
          return;
        }
      }
      
      function nameToPretty(betType){
        switch(betType){
        case 'passline':
          return "Pass Line";
          break;
        case 'passlineOdds':
          return "Pass Line Odds";
          break;
        case 'dontPass':
          return "Don't Pass";
          break;
        case 'dontPassOdds':
          return "Don't Pass Odds";
          break;
        case 'come':
          return "Come";
          break;
        case 'comeOdds':
          return "Come Odds";
          break;
        case 'dontCome':
          return "Don't Come";
          break;
        case 'dontComeOdds':
          return "Don't Come Odds";
          break;
        case 'place4':
          return "Place 4";
          break;
        case 'place5':
          return "Place 5";
          break;
        case 'place6':
          return "Place 6";
          break;
        case 'place8':
          return "Place 8";
          break;
        case 'place9':
          return "Place 9";
          break;
        case 'place10':
          return "Place 10";
          break;
        case 'big6':
          return "Big 6";
          break;
        case 'big8':
          return "Big 8";
          break;
        case 'field':
          return "Field";
          break;
        case 'cAndE':
          return "C and E";
          break;
        case 'any7':
          return "Seven";
          break;
        case 'hard4':
          return "Hard 4";
          break;
        case 'hard6':
          return "Hard 6";
          break;
        case 'hard8':
          return "Hard 8";
          break;
        case 'hard10':
          return "Hard 10";
          break;
        case 'aceTwo':
          return "Ace Two";
          break;
        case 'snakeEyes':
          return "Snake Eyes";
          break;
        case 'midnight':
          return "Midnight";
          break;
        case 'yoleven':
          return "Yo-leven";
          break;
        case 'anyCraps':
          return "Craps";
          break;
        case 'horn':
          return "Horn";
          break;
        case 'world':
          return "World";
          break;
        default:
          return;
        }
      }

    </script>
    <script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

      ga('create', 'UA-1424934-14', 'duleone.com');
      ga('send', 'pageview');

    </script>
    </footer>
</html>
